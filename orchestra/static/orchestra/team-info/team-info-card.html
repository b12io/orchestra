<section class="section-panel todo-list">
  <div class="container-fluid">
    <div class="row section-header">
      <div class="col-lg-12 col-md-12 col-sm-12">
        <h3>
          Team info
          <a class="btn"
             ng-if="teamInfoCard.isProjectAdmin"
             ng-href="project/{{teamInfoCard.projectId}}"
             target="_blank">
            Project Management
          </a>
          <a class="btn"
             ng-if="teamInfoCard.isProjectAdmin &&
                    (teamInfoCard.projectStatus === 'Active'
                    || teamInfoCard.projectStatus === 'Paused')"
             ng-click="teamInfoCard.togglePauseProject()">
             {{teamInfoCard.projectStatus == 'Paused' ? 'Unpause' : 'Pause'}} project
          </a>
        </h3>
      </div>
    </div>
    <div class="row section-body">
      <div class="col-lg-12 col-md-12 col-sm-12">
        <table class="table table-striped">
          <thead>
            <th>Role</th>
            <th>Username</th>
            <th>Name</th>
            <th>Recorded time spent</th>
            <th>Status</th>
          </thead>
          <tbody>
            <tr ng-repeat="assignment in teamInfoCard.assignments">
              <td>{{assignment.role}}</td>
              <td>{{assignment.worker.username}}
                <button
									class="btn btn-default btn-xs pull-right dsu-pl-30"
                  ng-if="teamInfoCard.isProjectAdmin && teamInfoCard.isTaskStaffable(assignment.task_status)"
                  ng-click="teamInfoCard.restaff(assignment.task_id, assignment.stepSlug)">
                  {{
                    teamInfoCard.sentStaffBotRequest[assignment.stepSlug]
                      ? teamInfoCard.sentStaffBotRequest[assignment.stepSlug]
                      : 'Restaff'
                  }}
								</button>
              </td>
              <td>{{assignment.worker.first_name}} {{assignment.worker.last_name}}</td>
              <td>{{assignment.recordedTime}}</td>
              <td>
                {{assignment.task_status}}
                <button type="submit"
                        class="btn btn-default btn-sm"
                        ng-if="teamInfoCard.isProjectAdmin &&
                               assignment.task_status == 'Processing' &&
                               assignment.stepSlug != teamInfoCard.step.slug"
                        ng-click="teamInfoCard.submitTask(assignment.task_id)">
                  Submit
                </button>
              </td>
            </tr>
            <tr>
              <td colspan="5">
                <a
                  class="btn"
                  ng-click="teamInfoCard.toggleShowUnassigned()">
                  {{teamInfoCard.showUnassigned ? 'Hide unassigned' : 'Show unassigned' }}
                </a>
              </td>
            </tr>
            <tr
              ng-if="teamInfoCard.showUnassigned"
              ng-repeat="unassigned in teamInfoCard.unassigned">
              <td>{{unassigned.role}}</td>
              <td></td>
              <td></td>
              <td>{{unassigned.recordedTime}}</td>
              <td>{{unassigned.status}}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</section>
